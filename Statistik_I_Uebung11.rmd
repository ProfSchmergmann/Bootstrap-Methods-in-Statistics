---
title: "Mathematische Statistik I Übung 13"
output: html_notebook
author: Sven Bergmann
---

## Aufgabe 1
1. Seien $Y \sim \text{EXP}(\lambda)$ und $Y \sim \text{EXP}(\mu)$ unabhängig, mit $\lambda\in(0,\infty) und $\mu\in(0,\infty)$ unbekannt. Sei $X = (Y, \min(Y,Z))\top$.

a) Bestimmen Sie die Randverteilungen von $X$.

b) Seien $X_1, \ldots, X_n$ unabhängig, je mit derselben Verteilung wie $X$. Gegeben seien $\lambda_0\in(0,\infty)$ und $\mu_0\in(0,\infty)$. Schlagen Sie unter Verwendung der Methode von Bonferroni einen Test zum Testniveau $\alpha\in(0,\infty)$ für das Testproblem
$$H:\lambda = \lambda_0 \text{ und } \mu = \mu_0, K: \lambda\neq\lambda_0 \text{ oder } \mu\neq\mu_0$$
basierend auf Beobachtungen von $X_1, \ldots, X_n$ vor. Überprüfen Sie für $\lambda_0=1$, $\mu_0=2$, $n = 10$ und $\alpha = 0.05$ mittels Simulation wie gut der Test das Testniveau einhält.
```{r}
draw_x <- function(n, lambda, mu) {
  y <- rexp(n = n, rate = lambda)
  return(cbind(y, pmin(y, rexp(n = n, rate = mu))))
}
```
```{r}
x <- draw_x(n = 10, lambda = 1, mu = 2)
```
## Aufgabe 2

Zu bekannten gegebenen Werten $t_i$ wurden die in der nachfolgenden Tabelle festgehaltenen Beobachtungswerte $x_i$ von Zufallsvariablen $X_i$ erhalten.

| $t_i$ | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 |
|-------|---|---|---|---|---|---|---|---|---|---|
| $x_i$ | 1 | 1 | 2 | 3 | 5 | 3 | 7 | 6 | 8 | 9 |

Es liege das Modell
$$X_i = a + bt_i + Z_i, a, b \in\mathbb{R}$$
unbekannt,
mit unabhängigen $\mathcal{N}(0, \sigma^2)$-verteilten Zufallsvariablen $Z_1, \ldots, Z_n$,
je mit derselben unbekannten Varianz $\sigma^2 > 0$ zugrunde.
Es sei $t_0 = 3.8$.
Geben Sie ein Konfidenzintervall zum Konfidenzniveau $0.95$ für $a + bt_0$ an.
```{r}
gamma <- 0.95
t_0 <- 3.8
t <- c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9)
x <- c(1, 1, 2, 3, 5, 3, 7, 6, 8, 9)
n <- length(x)
```
```{r}
x_bar <- mean(x)
alpha_hat <- x_bar

x_t_bar <- mean(x * t)
beta_hat <- x_t_bar

# sigma_hat_squared <- mean(x^2) - x_bar^2 - x_t_bar^2
# print(sigma_hat_squared)
sigma_hat_squared <- (1 / n) * sum(x - (alpha_hat - beta_hat * t))^2

c <- qt(df = n - 1, p = 1 - (gamma / 2))
term <- c * sqrt((sigma_hat_squared / (n - 2)) * (1 + t_0^2))
ci_lower <- alpha_hat + beta_hat * t_0 - term
ci_upper <- alpha_hat + beta_hat * t_0 + term

cat('Das Konfidenzintervall zum Konfidenzniveau', gamma, 'ist:')
cat('[', ci_lower, ',', ci_upper, ']')
```
```{r}
conf_guertel_schaetzer <- function(alpha_hat, beta_hat, t, n, gamma, sigma_hat_squared, lower) {
  term <- sqrt((2 / (n - 2)) *
                 qf(p = 1 - gamma, df1 = 2, df2 = n - 2) *
                 sigma_hat_squared *
                 (1 + t^2))
  return(ifelse(lower,
                alpha_hat + beta_hat * t - term,
                alpha_hat + beta_hat * t + term))
}
plot(t ~ x)
y <- lapply(X = t, FUN = function(t) conf_guertel_schaetzer(alpha_hat = alpha_hat, beta_hat = beta_hat, t = t, n = n, gamma = gamma, sigma_hat_squared = sigma_hat_squared, lower = TRUE))
lines(t, y)
```
```{r}
teststatistik <- (sqrt(n) * abs(x_t_bar)) / sqrt((1 / (n - 2)) * sum(x - x_bar - x_t_bar * t)^2)
t_n_minus_2_1_minus_half_alpha <- qt(df = n - 2, p = 1 - (gamma / 2))

cat('Für einen Test bei einfacher linarer Regression ist die Teststatistik:', teststatistik, 'und das zu vergleichende Quantil:', t_n_minus_2_1_minus_half_alpha)
```
